{% extends 'member/base.html' %}
{% load static %}

{% block title %}
EVEREST | Home
{% endblock %}

{% block content %}

<main class="">
  <!-- start Popup -->
  {% for message in messages %}
    {% if form.errors %}
      {% for field in form %}
        {% for error in field.errors %}
        <div class="alert alert-danger alert-dismissible"
          style="z-index: 2; background-color: #C0392B; position: absolute; margin-left: 2em; right: 2em; top: 8em;">
          <strong>{{ error|escape }}</strong>
          <button type="button" class="close btn btn-interact text-white" data-dismiss="alert"
            style="position: absolute; top:0; right: -2.7em;"><i class="far fa-times-circle fa-1x text-white"></i></button>
        </div>
        {% endfor %}
      {% endfor %}
    {% endif %}
    {% if message.level == DEFAULT_MESSAGE_LEVELS.ERROR %}
      <p class="alert alert-danger alert-link alert-dismissible text-white"
        style="z-index: 2; background-color: #C0392B; position: absolute; margin-left: 2em; right: 2em; top: 8em;">
        {{ message }}
        <button type="button" class="close btn btn-interact" data-dismiss="alert"
          style="position: absolute; top:0; right: -2.7em;"><i class="far fa-times-circle fa-1x text-white"></i></button>
      </p>
    {% else %}
      <p class="alert alert-success alert-link alert-dismissible text-white"
        style="z-index: 2; background-color: #27AE60; position: absolute; margin-left: 2em; right: 2em; top: 8em;">
        {{message}}
        <button type="button" class="close btn btn-interact" data-dismiss="alert"
          style="position: absolute; top:0; right: -2.7em;"><i class="far fa-times-circle fa-1x text-white"></i></button>
      </p>
    {% endif %}
  {% endfor %}
  <!-- end Popup -->
  <div class="container-fluid">
    <h2 style="font-weight: bold;">LATEST ANNOUNCEMENTS</h2>
    <div class="row">
      <div id="carouselIndicators" class="carousel slide carousel-fade" data-bs-ride="carousel" style="z-index: 0;">
        <div class="carousel-indicators">
          <button type="button" data-bs-target="#carouselIndicators" data-bs-slide-to="0" class="active" aria-current="true"
            aria-label="Slide 1"></button>
          <button type="button" data-bs-target="#carouselIndicators" data-bs-slide-to="1" aria-label="Slide 2"></button>
          <button type="button" data-bs-target="#carouselIndicators" data-bs-slide-to="2" aria-label="Slide 3"></button>
        </div>
        <div class="carousel-inner">
          <div class="carousel-item active">
            {% if banner1 %}
            <img class="announcement-banner d-block w-100" src="{{ banner1.banner_img.url }}" />
            {% else %}
            <div class="bg-success" style="height: 25.5em; text-align: center; display: flex; justify-content: center; align-items: center;">No announcement posted.</div>
            {% endif %}
          </div>
          <div class="carousel-item">
            {% if banner2 %}
            <img class="announcement-banner d-block w-100" src="{{ banner2.banner_img.url }}" />
            {% else %}
            <div class="bg-primary" style="height: 25.5em; text-align: center; display: flex; justify-content: center; align-items: center;">No announcement posted.</div>
            {% endif %}
          </div>
          <div class="carousel-item">
            {% if banner3 %}
            <img class="announcement-banner d-block w-100" src="{{ banner3.banner_img.url }}" />
            {% else %}
            <div class="bg-danger" style="height: 25.5em; text-align: center; display: flex; justify-content: center; align-items: center;">No announcement posted.</div>
            {% endif %}
          </div>
        </div>
        <a class="carousel-control-prev" href="#carouselIndicators" role="button" data-slide="prev">
          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
          <span class="sr-only">Previous</span>
        </a>
        <a class="carousel-control-next" href="#carouselIndicators" role="button" data-slide="next">
          <span class="carousel-control-next-icon" aria-hidden="true"></span>
          <span class="sr-only">Next</span>
        </a>
      </div>
    </div>
    <div class="row my-4">
      <div class="col container-fluid">
        <div class="row">
          <div class="col container-fluid">
            <div class="card text-white bg-success mb-3 shadow-sm rounded">
              <div class="card-header">
                <h6 class="card-title" style="font-weight: bold; text-transform: uppercase;">Total Number of Approved Transactions
                </h6>
              </div>
              <div class="card-body d-flex">
                <i class="fas fa-clipboard-check fa-3x"></i>
                <h5 class="card-title" style="font-size: 3rem; margin-left: 1rem; font-weight: bold;">{{ approved }}</h5>
              </div>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col container-fluid">
            <div class="card text-white bg-primary mb-3 shadow-sm rounded">
              <div class="card-header">
                <h6 class="card-title" style="font-weight: bold; text-transform: uppercase;">Total Number of Pending Transactions
                </h6>
              </div>
              <div class="card-body d-flex">
                <i class="fas fa-receipt fa-3x"></i>
                <h5 class="card-title" style="font-size: 3rem; margin-left: 1rem; font-weight: bold;">{{ pending }}</h5>
              </div>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col container-fluid">
            <div class="card text-white bg-danger mb-3 shadow-sm rounded">
              <div class="card-header">
                <h6 class="card-title" style="font-weight: bold; text-transform: uppercase;">Total Number of Rejected Transactions
                </h6>
              </div>
              <div class="card-body d-flex">
                <i class="fas fa-ban fa-3x"></i>
                <h5 class="card-title" style="font-size: 3rem; margin-left: 1rem; font-weight: bold;">{{ rejected }}</h5>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col">
        <div class="col mb-4">
          <div class=" container-fluid form-control shadow" style="border: none;">
            <h5 style="font-weight: bold;">RECENT TRANSACTIONS</h5>
            <hr>
            <div style="overflow-x: scroll; overflow-y: scroll; overflow:auto">
              <table class="table table-striped table-hover" style="width: 100%;">
                <thead class="thead-dark" style="color: white; background-color: rgba(36, 36, 36, 0.986);">
                  <tr>
                    <th scope="col">TID</th>
                    <th scope="col">EVENT</th>
                    <th scope="col">DATE</th>
                    <th scope="col">STATUS</th>
                  </tr>
                </thead>
                <tbody>
                  {% for transaction in registered_events %}
                  <tr>
                    <td>{{ transaction.id }}</td>
                    <td>{{ transaction.event.event_name }}</td>
                    <td style="text-transform: uppercase;">{{ transaction.date_created }}</td>
                    <td
                      class="{% if transaction.is_registration_approved == 'APPROVED' %}bg-success{% elif transaction.is_registration_approved == 'PENDING' %}bg-primary{% else %}bg-danger{% endif %}"
                      style="text-align: center; color: white;">{{ transaction.is_registration_approved }}</td>
                  </tr>
                  {% empty %}
                  <tr>
                    <td colspan="4" class="text-center">No transactions made yet.</td>
                  </tr>
                  {% endfor %}
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

</main>

{% endblock %}